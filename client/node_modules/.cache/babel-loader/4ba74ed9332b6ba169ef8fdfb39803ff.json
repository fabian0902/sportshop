{"ast":null,"code":"import{useState,useEffect}from'react';import axios from'axios';axios.defaults.withCredentials=true;function UserAPI(token){//NO OLVIDAR PASAR EL TOKEN A LA FUNCION PRINCIPAL\nconst[isLogged,setIsLogged]=useState(false);const[isAdmin,setIsAdmin]=useState(false);const[cart,setCart]=useState([]);const[history,setHistory]=useState([]);useEffect(()=>{if(token){const getUser=async()=>{try{const res=await axios.get(\"/user/infor\",{headers:{Authorization:token}});setIsLogged(true);res.data.role===1?setIsAdmin(true):setIsAdmin(false);setCart(res.data.cart);}catch(err){alert(err.response.data.msg);}};getUser();//no olvidar iniciar la funcion\n}},[token]);const addCart=async product=>{if(!isLogged)return alert(\"Favor iniciar sesi칩n o login para comprar\");const check=cart.every(item=>{return item._id!==product._id;});if(check){setCart([...cart,{...product,quantity:1}]);await axios.patch(\"/user/addcart\",{cart:[...cart,{...product,quantity:0}]},{headers:{Authorization:token}});}else{alert(\"Este producto ha sido a침adido a su carrito de compras\");}};return{isLogged:[isLogged,setIsLogged],isAdmin:[isAdmin,setIsAdmin],cart:[cart,setCart],addCart:addCart,history:[history,setHistory]};}export default UserAPI;","map":{"version":3,"names":["useState","useEffect","axios","defaults","withCredentials","UserAPI","token","isLogged","setIsLogged","isAdmin","setIsAdmin","cart","setCart","history","setHistory","getUser","res","get","headers","Authorization","data","role","err","alert","response","msg","addCart","product","check","every","item","_id","quantity","patch"],"sources":["C:/Users/Fabian FF/Desktop/envio/sportShop/client/src/api/UserAPI.js"],"sourcesContent":["import {useState, useEffect} from 'react';\nimport axios from 'axios';  \n\n\naxios.defaults.withCredentials = true \n\nfunction UserAPI(token) { //NO OLVIDAR PASAR EL TOKEN A LA FUNCION PRINCIPAL\n    const [isLogged, setIsLogged] = useState(false)\n    const [isAdmin, setIsAdmin] = useState(false)\n    const [cart, setCart] = useState([])\n    const [history, setHistory] = useState([])\n\n    useEffect(()=>{\n        if(token){\n            const getUser = async ()=>{\n                try {\n                    const res = await axios.get(\"/user/infor\", {\n                        headers: {Authorization: token}\n                    })\n                    setIsLogged(true)\n                    res.data.role === 1 ? setIsAdmin(true) : setIsAdmin(false)\n                    setCart(res.data.cart)\n                    \n                } catch (err) {\n                    alert(err.response.data.msg)\n                }\n            }\n            getUser()//no olvidar iniciar la funcion\n        }\n\n    },[token])\n\n    \n\n\n    const addCart =  async (product)=>{\n        if(!isLogged) return alert(\"Favor iniciar sesi칩n o login para comprar\")\n\n        const check = cart.every(item=>{\n            return item._id !== product._id\n        })\n        if(check){\n            setCart([...cart,{...product, quantity: 1}])\n            await axios.patch(\"/user/addcart\", {cart:[...cart,{...product, quantity: 0}]},{\n                headers: {Authorization: token}\n            })\n        }else{\n            alert(\"Este producto ha sido a침adido a su carrito de compras\")\n        }\n    }\n    return { \n        isLogged : [isLogged, setIsLogged],\n        isAdmin: [isAdmin, setIsAdmin],\n        cart: [cart, setCart],\n        addCart: addCart,\n        history: [history, setHistory]\n\n}\n}\n\nexport default UserAPI;\n"],"mappings":"AAAA,OAAQA,QAAQ,CAAEC,SAAS,KAAO,OAAO,CACzC,MAAO,CAAAC,KAAK,KAAM,OAAO,CAGzBA,KAAK,CAACC,QAAQ,CAACC,eAAe,CAAG,IAAI,CAErC,QAAS,CAAAC,OAAOA,CAACC,KAAK,CAAE,CAAE;AACtB,KAAM,CAACC,QAAQ,CAAEC,WAAW,CAAC,CAAGR,QAAQ,CAAC,KAAK,CAAC,CAC/C,KAAM,CAACS,OAAO,CAAEC,UAAU,CAAC,CAAGV,QAAQ,CAAC,KAAK,CAAC,CAC7C,KAAM,CAACW,IAAI,CAAEC,OAAO,CAAC,CAAGZ,QAAQ,CAAC,EAAE,CAAC,CACpC,KAAM,CAACa,OAAO,CAAEC,UAAU,CAAC,CAAGd,QAAQ,CAAC,EAAE,CAAC,CAE1CC,SAAS,CAAC,IAAI,CACV,GAAGK,KAAK,CAAC,CACL,KAAM,CAAAS,OAAO,CAAG,KAAAA,CAAA,GAAU,CACtB,GAAI,CACA,KAAM,CAAAC,GAAG,CAAG,KAAM,CAAAd,KAAK,CAACe,GAAG,CAAC,aAAa,CAAE,CACvCC,OAAO,CAAE,CAACC,aAAa,CAAEb,KAAK,CAClC,CAAC,CAAC,CACFE,WAAW,CAAC,IAAI,CAAC,CACjBQ,GAAG,CAACI,IAAI,CAACC,IAAI,GAAK,CAAC,CAAGX,UAAU,CAAC,IAAI,CAAC,CAAGA,UAAU,CAAC,KAAK,CAAC,CAC1DE,OAAO,CAACI,GAAG,CAACI,IAAI,CAACT,IAAI,CAAC,CAE1B,CAAE,MAAOW,GAAG,CAAE,CACVC,KAAK,CAACD,GAAG,CAACE,QAAQ,CAACJ,IAAI,CAACK,GAAG,CAAC,CAChC,CACJ,CAAC,CACDV,OAAO,CAAC,CAAC;AACb,CAEJ,CAAC,CAAC,CAACT,KAAK,CAAC,CAAC,CAKV,KAAM,CAAAoB,OAAO,CAAI,KAAO,CAAAC,OAAO,EAAG,CAC9B,GAAG,CAACpB,QAAQ,CAAE,MAAO,CAAAgB,KAAK,CAAC,2CAA2C,CAAC,CAEvE,KAAM,CAAAK,KAAK,CAAGjB,IAAI,CAACkB,KAAK,CAACC,IAAI,EAAE,CAC3B,MAAO,CAAAA,IAAI,CAACC,GAAG,GAAKJ,OAAO,CAACI,GAAG,CACnC,CAAC,CAAC,CACF,GAAGH,KAAK,CAAC,CACLhB,OAAO,CAAC,CAAC,GAAGD,IAAI,CAAC,CAAC,GAAGgB,OAAO,CAAEK,QAAQ,CAAE,CAAC,CAAC,CAAC,CAAC,CAC5C,KAAM,CAAA9B,KAAK,CAAC+B,KAAK,CAAC,eAAe,CAAE,CAACtB,IAAI,CAAC,CAAC,GAAGA,IAAI,CAAC,CAAC,GAAGgB,OAAO,CAAEK,QAAQ,CAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAC1Ed,OAAO,CAAE,CAACC,aAAa,CAAEb,KAAK,CAClC,CAAC,CAAC,CACN,CAAC,IAAI,CACDiB,KAAK,CAAC,uDAAuD,CAAC,CAClE,CACJ,CAAC,CACD,MAAO,CACHhB,QAAQ,CAAG,CAACA,QAAQ,CAAEC,WAAW,CAAC,CAClCC,OAAO,CAAE,CAACA,OAAO,CAAEC,UAAU,CAAC,CAC9BC,IAAI,CAAE,CAACA,IAAI,CAAEC,OAAO,CAAC,CACrBc,OAAO,CAAEA,OAAO,CAChBb,OAAO,CAAE,CAACA,OAAO,CAAEC,UAAU,CAErC,CAAC,CACD,CAEA,cAAe,CAAAT,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module"}