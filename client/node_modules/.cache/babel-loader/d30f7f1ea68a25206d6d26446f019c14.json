{"ast":null,"code":"import{createContext,useState,useEffect}from'react';import ProductsAPI from'./api/ProductsAPI';import UserAPI from'./api/UserAPI';import axios from'axios';import CategoriesAPI from'./api/CategoriesAPI';import{jsx as _jsx}from\"react/jsx-runtime\";axios.defaults.withCredentials=true;export const GlobalState=/*#__PURE__*/createContext();export const DataProvider=_ref=>{let{children}=_ref;const[token,setToken]=useState(false);useEffect(()=>{const firstLogin=localStorage.getItem(\"firstLogin\");if(firstLogin){const refreshToken=async()=>{try{const res=await axios.get(\"/user/refresh_token\");setToken(res.data.accesstoken);setTimeout(()=>{refreshToken();},10*60*1000);}catch(err){if(err.response){console.error(`Error en la respuesta del servidor: ${err.response.status} - ${err.response.data}`);}else if(err.request){console.error('No hubo respuesta del servidor:',err.request);}else{console.error('Error:',err.message);}}};refreshToken();}},[]);ProductsAPI();const state={token:[token,setToken],ProductsAPI:ProductsAPI(),UserAPI:UserAPI(token),CategoriesAPI:CategoriesAPI()};return/*#__PURE__*/_jsx(GlobalState.Provider,{value:state,children:children});};","map":{"version":3,"names":["createContext","useState","useEffect","ProductsAPI","UserAPI","axios","CategoriesAPI","jsx","_jsx","defaults","withCredentials","GlobalState","DataProvider","_ref","children","token","setToken","firstLogin","localStorage","getItem","refreshToken","res","get","data","accesstoken","setTimeout","err","response","console","error","status","request","message","state","Provider","value"],"sources":["C:/Users/Fabian FF/Desktop/envio/sportShop/client/src/GlobalState.js"],"sourcesContent":["import {createContext, useState, useEffect} from 'react';\nimport ProductsAPI  from './api/ProductsAPI';\nimport UserAPI  from './api/UserAPI';\nimport axios from 'axios';\nimport CategoriesAPI from './api/CategoriesAPI';\n\naxios.defaults.withCredentials = true \n\nexport const GlobalState = createContext()\n\nexport const DataProvider = ({children}) =>{\n\n    const [token, setToken] = useState(false)\n    \n    \n    useEffect(() => {\n        const firstLogin = localStorage.getItem(\"firstLogin\");\n        if (firstLogin) {\n            const refreshToken = async () => {\n                try {\n                    const res = await axios.get(\"/user/refresh_token\");\n                    setToken(res.data.accesstoken);\n                    setTimeout(() => {\n                        refreshToken();\n                    }, 10 * 60 * 1000);\n                } catch (err) {\n                    if (err.response) {\n                        console.error(`Error en la respuesta del servidor: ${err.response.status} - ${err.response.data}`);\n                    } else if (err.request) {\n                        console.error('No hubo respuesta del servidor:', err.request);\n                    } else {\n                        console.error('Error:', err.message);\n                    }\n                }\n            };\n            refreshToken();\n        }\n    }, []);\n\n\n    ProductsAPI()\n    const state={\n        token: [token, setToken],\n        ProductsAPI: ProductsAPI(),\n        UserAPI : UserAPI(token),\n        CategoriesAPI: CategoriesAPI()\n    }\n\n    return(\n        <GlobalState.Provider value={state}>\n            {children}\n        </GlobalState.Provider>\n    )\n}\n\n"],"mappings":"AAAA,OAAQA,aAAa,CAAEC,QAAQ,CAAEC,SAAS,KAAO,OAAO,CACxD,MAAO,CAAAC,WAAW,KAAO,mBAAmB,CAC5C,MAAO,CAAAC,OAAO,KAAO,eAAe,CACpC,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,MAAO,CAAAC,aAAa,KAAM,qBAAqB,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAEhDH,KAAK,CAACI,QAAQ,CAACC,eAAe,CAAG,IAAI,CAErC,MAAO,MAAM,CAAAC,WAAW,cAAGX,aAAa,CAAC,CAAC,CAE1C,MAAO,MAAM,CAAAY,YAAY,CAAGC,IAAA,EAAe,IAAd,CAACC,QAAQ,CAAC,CAAAD,IAAA,CAEnC,KAAM,CAACE,KAAK,CAAEC,QAAQ,CAAC,CAAGf,QAAQ,CAAC,KAAK,CAAC,CAGzCC,SAAS,CAAC,IAAM,CACZ,KAAM,CAAAe,UAAU,CAAGC,YAAY,CAACC,OAAO,CAAC,YAAY,CAAC,CACrD,GAAIF,UAAU,CAAE,CACZ,KAAM,CAAAG,YAAY,CAAG,KAAAA,CAAA,GAAY,CAC7B,GAAI,CACA,KAAM,CAAAC,GAAG,CAAG,KAAM,CAAAhB,KAAK,CAACiB,GAAG,CAAC,qBAAqB,CAAC,CAClDN,QAAQ,CAACK,GAAG,CAACE,IAAI,CAACC,WAAW,CAAC,CAC9BC,UAAU,CAAC,IAAM,CACbL,YAAY,CAAC,CAAC,CAClB,CAAC,CAAE,EAAE,CAAG,EAAE,CAAG,IAAI,CAAC,CACtB,CAAE,MAAOM,GAAG,CAAE,CACV,GAAIA,GAAG,CAACC,QAAQ,CAAE,CACdC,OAAO,CAACC,KAAK,CAAC,uCAAuCH,GAAG,CAACC,QAAQ,CAACG,MAAM,MAAMJ,GAAG,CAACC,QAAQ,CAACJ,IAAI,EAAE,CAAC,CACtG,CAAC,IAAM,IAAIG,GAAG,CAACK,OAAO,CAAE,CACpBH,OAAO,CAACC,KAAK,CAAC,iCAAiC,CAAEH,GAAG,CAACK,OAAO,CAAC,CACjE,CAAC,IAAM,CACHH,OAAO,CAACC,KAAK,CAAC,QAAQ,CAAEH,GAAG,CAACM,OAAO,CAAC,CACxC,CACJ,CACJ,CAAC,CACDZ,YAAY,CAAC,CAAC,CAClB,CACJ,CAAC,CAAE,EAAE,CAAC,CAGNjB,WAAW,CAAC,CAAC,CACb,KAAM,CAAA8B,KAAK,CAAC,CACRlB,KAAK,CAAE,CAACA,KAAK,CAAEC,QAAQ,CAAC,CACxBb,WAAW,CAAEA,WAAW,CAAC,CAAC,CAC1BC,OAAO,CAAGA,OAAO,CAACW,KAAK,CAAC,CACxBT,aAAa,CAAEA,aAAa,CAAC,CACjC,CAAC,CAED,mBACIE,IAAA,CAACG,WAAW,CAACuB,QAAQ,EAACC,KAAK,CAAEF,KAAM,CAAAnB,QAAA,CAC9BA,QAAQ,CACS,CAAC,CAE/B,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module"}