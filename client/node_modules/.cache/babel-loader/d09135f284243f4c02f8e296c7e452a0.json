{"ast":null,"code":"import React,{useContext,useState}from'react';import{GlobalState}from'../../../GlobalState';import ProductItem from'../utils/productItem/ProductItem';import Loading from\"../utils/loading/Loading\";import axios from'axios';import Filters from'./Filters';import LoadMore from'./LoadMore';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";axios.defaults.withCredentials=true;function Products(){const state=useContext(GlobalState);const[products,setProducts]=state.ProductsAPI.products;const[isAdmin]=state.UserAPI.isAdmin;const[token]=state.token;const[callback,setCallback]=state.ProductsAPI.callback;const[loading,setLoading]=useState(false);const[isCheck,setIsCheck]=useState(false);const handleCheck=id=>{products.forEach(product=>{if(product._id===id)product.checked=!product.checked;});setProducts([...products]);};const deleteProduct=async(id,public_id)=>{try{setLoading(true);const destroyImg=axios.post(\"/api/destroy\",{public_id},{headers:{Authorization:token}});const deleteProduct=axios.delete(`/api/products/${id}`,{headers:{Authorization:token}});await destroyImg;await deleteProduct;setLoading(false);setCallback(!callback);}catch(err){alert(err.response.data.msg);}};const checkAll=()=>{products.forEach(product=>{product.checked=!isCheck;});setProducts([...products]);setIsCheck(!isCheck);};const deleteAll=()=>{products.forEach(product=>{if(product.checked)deleteProduct(product._id,product.images.public_id);});};if(loading)return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Loading,{})});return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Filters,{}),isAdmin&&/*#__PURE__*/_jsxs(\"div\",{className:\"delete-all\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Seleccionar Todos\"}),/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:isCheck,onChange:checkAll}),/*#__PURE__*/_jsx(\"button\",{onClick:deleteAll,children:\"Borrar Todos\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"products\",children:products.map(product=>{return/*#__PURE__*/_jsx(ProductItem,{product:product,isAdmin:isAdmin,deleteProduct:deleteProduct,handleCheck:handleCheck},product._id);})}),/*#__PURE__*/_jsx(LoadMore,{}),products.length===0&&/*#__PURE__*/_jsx(Loading,{})]});}export default Products;","map":{"version":3,"names":["React","useContext","useState","GlobalState","ProductItem","Loading","axios","Filters","LoadMore","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","defaults","withCredentials","Products","state","products","setProducts","ProductsAPI","isAdmin","UserAPI","token","callback","setCallback","loading","setLoading","isCheck","setIsCheck","handleCheck","id","forEach","product","_id","checked","deleteProduct","public_id","destroyImg","post","headers","Authorization","delete","err","alert","response","data","msg","checkAll","deleteAll","images","children","className","type","onChange","onClick","map","length"],"sources":["C:/Users/Fabian FF/Desktop/envio/sportShop/client/src/components/mainpages/products/Products.js"],"sourcesContent":["import React,{useContext,useState} from 'react';\nimport {GlobalState} from '../../../GlobalState';\nimport ProductItem from '../utils/productItem/ProductItem';\nimport Loading from \"../utils/loading/Loading\"\nimport axios from 'axios';\nimport Filters from './Filters';\nimport LoadMore from './LoadMore'\n\naxios.defaults.withCredentials = true\n\nfunction Products() {\n\n  const state = useContext(GlobalState)\n  const [products, setProducts] = state.ProductsAPI.products\n  const [isAdmin] = state.UserAPI.isAdmin \n  const [token] = state.token\n  const [callback , setCallback] = state.ProductsAPI.callback\n  const [loading, setLoading] = useState(false)\n  const [isCheck, setIsCheck] = useState(false)\n\n  \n\n\n  const handleCheck = (id)=>{\n    products.forEach(product=>{\n      if(product._id === id) product.checked = !product.checked\n    })\n    setProducts([...products])\n  }\n\n  const deleteProduct = async (id,public_id) =>{\n\n    try {\n      setLoading(true)\n      const destroyImg =  axios.post(\"/api/destroy\",{public_id},{\n        headers: {Authorization: token}\n      })\n      const deleteProduct =  axios.delete(`/api/products/${id}`,{\n        headers: {Authorization: token}\n      })\n     \n      await destroyImg\n      await deleteProduct\n      setLoading(false)\n      setCallback(!callback)\n\n    } catch (err) {\n        alert(err.response.data.msg)\n    }\n  }\n\n   const checkAll = () =>{\n    products.forEach(product =>{\n      product.checked = !isCheck\n    })\n    setProducts([...products])\n    setIsCheck(!isCheck)\n  }\n\n  const deleteAll = () =>{\n    products.forEach(product =>{\n      if(product.checked) deleteProduct(product._id, product.images.public_id)\n    })\n  }\n\n\n  if(loading) return  <div><Loading/></div>\n\n\n  return (\n    <>\n    <Filters/>\n\n    {\n      isAdmin && \n      <div className='delete-all'>\n        <span>Seleccionar Todos</span>\n        <input type=\"checkbox\" checked={isCheck} onChange={checkAll} />\n        <button onClick={deleteAll}>Borrar Todos</button>\n\n      </div>\n    }\n    <div className='products' >\n        {\n          products.map(product =>{\n            return <ProductItem key={product._id} product={product} \n            isAdmin={isAdmin} deleteProduct={deleteProduct} handleCheck={handleCheck}\n            />\n          })\n        }\n    </div>\n\n      <LoadMore/>\n      \n      {products.length === 0 && <Loading/>} \n    </>\n  );\n}\n\nexport default Products;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}