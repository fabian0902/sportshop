{"ast":null,"code":"import React,{useContext,useState,useEffect}from'react';import{GlobalState}from'../../../GlobalState';import axios from'axios';import PaypalButton from'./PaypalButton';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";axios.defaults.withCredentials=true;function Cart(){const state=useContext(GlobalState);const[cart,setCart]=state.UserAPI.cart;const[token]=state.token;const[total,setTotal]=useState(0);useEffect(()=>{const getTotal=()=>{const total=cart.reduce((prev,item)=>{return prev+item.price*item.quantity;},0);setTotal(total);};getTotal();},[cart]);const addToCart=async cart=>{await axios.patch(\"/user/addcart\",{cart},{headers:{Authorization:token}});};const increment=id=>{cart.forEach(item=>{if(item._id===id){item.quantity+=1;}});setCart([...cart]);addToCart(cart);};const decrement=id=>{cart.forEach(item=>{if(item._id===id){item.quantity===1?item.quantity=1:item.quantity-=1;}});setCart([...cart]);addToCart(cart);};const removeProduct=id=>{if(window.confirm(\"esta seguro que quiere eliminar este producto de su carrito?\")){cart.forEach((item,index)=>{if(item._id===id){cart.splice(index,1);}});setCart([...cart]);addToCart(cart);}};const tranSuccess=async payment=>{const{paymentID,address}=payment;await axios.post(\"/api/payment\",{cart,paymentID,address},{headers:{Authorization:token}});setCart([]);addToCart([]);alert(\"Ha realizado un pedido con éxito.\");};if(cart.length===0)return/*#__PURE__*/_jsx(\"h2\",{style:{textAlign:\"center\",fontSize:\"5rem\"},children:\"Su Carrito est\\xE1 Vac\\xEDo\"});return/*#__PURE__*/_jsxs(\"div\",{children:[cart.map(product=>/*#__PURE__*/_jsxs(\"div\",{className:\"detail cart\",children:[/*#__PURE__*/_jsx(\"img\",{src:product.images.url,alt:\"\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"box-detail\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[product.title,\" \"]}),/*#__PURE__*/_jsxs(\"h3\",{children:[\"$\",product.price*product.quantity,\" \"]}),/*#__PURE__*/_jsxs(\"p\",{children:[product.description,\" \"]}),/*#__PURE__*/_jsxs(\"p\",{children:[product.content,\" \"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"amount\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>decrement(product._id),children:\" - \"}),/*#__PURE__*/_jsxs(\"span\",{children:[\" \",product.quantity,\" \"]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>increment(product._id),children:\" + \"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"delete\",onClick:()=>removeProduct(product._id),children:\"X\"})]})]},product._id)),/*#__PURE__*/_jsxs(\"div\",{className:\"total\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Total: $ \",total,\" \"]}),/*#__PURE__*/_jsx(PaypalButton,{total:total,tranSuccess:tranSuccess})]})]});}export default Cart;","map":{"version":3,"names":["React","useContext","useState","useEffect","GlobalState","axios","PaypalButton","jsx","_jsx","jsxs","_jsxs","defaults","withCredentials","Cart","state","cart","setCart","UserAPI","token","total","setTotal","getTotal","reduce","prev","item","price","quantity","addToCart","patch","headers","Authorization","increment","id","forEach","_id","decrement","removeProduct","window","confirm","index","splice","tranSuccess","payment","paymentID","address","post","alert","length","style","textAlign","fontSize","children","map","product","className","src","images","url","alt","title","description","content","onClick"],"sources":["C:/Users/Fabian FF/Desktop/envio/sportShop/client/src/components/mainpages/cart/Cart.js"],"sourcesContent":["import React,{useContext, useState, useEffect} from 'react';\nimport {GlobalState} from '../../../GlobalState';\nimport axios from 'axios';\nimport PaypalButton from './PaypalButton';\n\n\naxios.defaults.withCredentials=true\n\nfunction Cart() {\n\n  const state = useContext(GlobalState)\n  const[cart, setCart] = state.UserAPI.cart\n  const [token] = state.token\n  const [total, setTotal]= useState(0)\n\n\n  \n\n  useEffect(()=>{\n    const getTotal = () =>{\n      const total = cart.reduce((prev, item)=>{\n            return prev + (item.price * item.quantity)\n      },0)\n      setTotal(total)\n    }\n    getTotal()\n  },[cart])\n\n  const addToCart = async (cart)=>{\n    await axios.patch(\"/user/addcart\",{cart},{\n      headers: {Authorization: token}\n    })\n  }\n\n  const increment = (id) =>{\n    cart.forEach(item=>{\n      if(item._id === id){\n        item.quantity += 1\n      }\n    })\n    setCart([...cart])\n    addToCart(cart)\n  }\n  const decrement = (id) =>{\n    cart.forEach(item=>{\n      if(item._id === id){\n        item.quantity === 1 ? item.quantity = 1 : item.quantity -= 1\n      }\n    })\n    setCart([...cart])\n    addToCart(cart)\n  }\n  const removeProduct = id =>{\n    if(window.confirm (\"esta seguro que quiere eliminar este producto de su carrito?\")){\n        cart.forEach((item,index)=>{\n          if(item._id ===  id){\n            cart.splice( index, 1)\n          }\n        })\n        setCart([...cart])\n        addToCart(cart)\n    }\n  }\n\n  const tranSuccess = async (payment)=>{\n    \n    const {paymentID, address} = payment\n\n      await axios.post(\"/api/payment\", {cart, paymentID, address},{\n         headers: {Authorization: token}\n      })\n      setCart([])\n      addToCart([])\n      alert(\"Ha realizado un pedido con éxito.\")\n  }\n\n\n  if(cart.length === 0)\n  return  <h2 style={{textAlign: \"center\", fontSize:\"5rem\"}} >Su Carrito está Vacío</h2>\n\n\n\n  return (\n    <div>\n        {\n          cart.map(product =>(\n           \n\n            <div className='detail cart' key={product._id} >\n              <img src={product.images.url} alt=\"\" />{/* aca cambie detailProduct por product */}\n                <div className='box-detail'>\n                    <h2>{product.title} </h2>\n                        \n                    <h3>${product.price * product.quantity} </h3>\n                    <p>{product.description} </p>\n                    <p>{product.content} </p>\n                    <div className=\"amount\">\n                      <button onClick={()=> decrement(product._id)}> - </button>\n                      \n                      <span> {product.quantity} </span>\n                      <button onClick={()=> increment(product._id)}> + </button>\n                    </div>\n                    <div className=\"delete\" onClick={()=>removeProduct(product._id)}>X</div>\n                </div>\n            </div>\n\n          ))\n        }\n        <div className=\"total\">\n          <h3>Total: $ {total} </h3>\n          <PaypalButton total={total} tranSuccess={tranSuccess} />\n        </div>\n\n\n    </div>\n  );\n}\n\nexport default Cart;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}