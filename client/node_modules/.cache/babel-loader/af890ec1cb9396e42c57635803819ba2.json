{"ast":null,"code":"import _asyncToGenerator from\"C:\\\\Users\\\\Fabian FF\\\\Desktop\\\\envio\\\\sportShop\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";import _slicedToArray from\"C:\\\\Users\\\\Fabian FF\\\\Desktop\\\\envio\\\\sportShop\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\Fabian FF\\\\Desktop\\\\envio\\\\sportShop\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import{createContext,useState,useEffect}from'react';import ProductsAPI from'./api/ProductsAPI';import UserAPI from'./api/UserAPI';import axios from'axios';import CategoriesAPI from'./api/CategoriesAPI';import{jsx as _jsx}from\"react/jsx-runtime\";axios.defaults.withCredentials=true;export var GlobalState=/*#__PURE__*/createContext();export var DataProvider=function DataProvider(_ref){var children=_ref.children;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),token=_useState2[0],setToken=_useState2[1];useEffect(function(){var firstLogin=localStorage.getItem(\"firstLogin\");if(firstLogin){var refreshToken=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(\"/user/refresh_token\");case 3:res=_context.sent;setToken(res.data.accesstoken);setTimeout(function(){refreshToken();},10*60*1000);_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);if(_context.t0.response){console.error(\"Error en la respuesta del servidor: \".concat(_context.t0.response.status,\" - \").concat(_context.t0.response.data));}else if(_context.t0.request){console.error('No hubo respuesta del servidor:',_context.t0.request);}else{console.error('Error:',_context.t0.message);}case 11:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));return function refreshToken(){return _ref2.apply(this,arguments);};}();refreshToken();}},[]);ProductsAPI();var state={token:[token,setToken],ProductsAPI:ProductsAPI(),UserAPI:UserAPI(token),CategoriesAPI:CategoriesAPI()};return/*#__PURE__*/_jsx(GlobalState.Provider,{value:state,children:children});};","map":{"version":3,"sources":["C:/Users/Fabian FF/Desktop/envio/sportShop/client/src/GlobalState.js"],"names":["createContext","useState","useEffect","ProductsAPI","UserAPI","axios","CategoriesAPI","defaults","withCredentials","GlobalState","DataProvider","children","token","setToken","firstLogin","localStorage","getItem","refreshToken","get","res","data","accesstoken","setTimeout","response","console","error","status","request","message","state"],"mappings":"2bAAA,OAAQA,aAAR,CAAuBC,QAAvB,CAAiCC,SAAjC,KAAiD,OAAjD,CACA,MAAOC,CAAAA,WAAP,KAAyB,mBAAzB,CACA,MAAOC,CAAAA,OAAP,KAAqB,eAArB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,aAAP,KAA0B,qBAA1B,C,2CAEAD,KAAK,CAACE,QAAN,CAAeC,eAAf,CAAiC,IAAjC,CAEA,MAAO,IAAMC,CAAAA,WAAW,cAAGT,aAAa,EAAjC,CAEP,MAAO,IAAMU,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,MAAe,IAAbC,CAAAA,QAAa,MAAbA,QAAa,CAEvC,cAA0BV,QAAQ,CAAC,KAAD,CAAlC,wCAAOW,KAAP,eAAcC,QAAd,eAGAX,SAAS,CAAC,UAAM,CACZ,GAAMY,CAAAA,UAAU,CAAGC,YAAY,CAACC,OAAb,CAAqB,YAArB,CAAnB,CACA,GAAIF,UAAJ,CAAgB,CACZ,GAAMG,CAAAA,YAAY,2FAAG,iLAEKZ,CAAAA,KAAK,CAACa,GAAN,CAAU,qBAAV,CAFL,QAEPC,GAFO,eAGbN,QAAQ,CAACM,GAAG,CAACC,IAAJ,CAASC,WAAV,CAAR,CACAC,UAAU,CAAC,UAAM,CACbL,YAAY,GACf,CAFS,CAEP,GAAK,EAAL,CAAU,IAFH,CAAV,CAJa,+EAQb,GAAI,YAAIM,QAAR,CAAkB,CACdC,OAAO,CAACC,KAAR,+CAAqD,YAAIF,QAAJ,CAAaG,MAAlE,eAA8E,YAAIH,QAAJ,CAAaH,IAA3F,GACH,CAFD,IAEO,IAAI,YAAIO,OAAR,CAAiB,CACpBH,OAAO,CAACC,KAAR,CAAc,iCAAd,CAAiD,YAAIE,OAArD,EACH,CAFM,IAEA,CACHH,OAAO,CAACC,KAAR,CAAc,QAAd,CAAwB,YAAIG,OAA5B,EACH,CAdY,oEAAH,kBAAZX,CAAAA,YAAY,2CAAlB,CAiBAA,YAAY,GACf,CACJ,CAtBQ,CAsBN,EAtBM,CAAT,CAyBAd,WAAW,GACX,GAAM0B,CAAAA,KAAK,CAAC,CACRjB,KAAK,CAAE,CAACA,KAAD,CAAQC,QAAR,CADC,CAERV,WAAW,CAAEA,WAAW,EAFhB,CAGRC,OAAO,CAAGA,OAAO,CAACQ,KAAD,CAHT,CAIRN,aAAa,CAAEA,aAAa,EAJpB,CAAZ,CAOA,mBACI,KAAC,WAAD,CAAa,QAAb,EAAsB,KAAK,CAAEuB,KAA7B,UACKlB,QADL,EADJ,CAKH,CA3CM","sourcesContent":["import {createContext, useState, useEffect} from 'react';\nimport ProductsAPI  from './api/ProductsAPI';\nimport UserAPI  from './api/UserAPI';\nimport axios from 'axios';\nimport CategoriesAPI from './api/CategoriesAPI';\n\naxios.defaults.withCredentials = true \n\nexport const GlobalState = createContext()\n\nexport const DataProvider = ({children}) =>{\n\n    const [token, setToken] = useState(false)\n    \n    \n    useEffect(() => {\n        const firstLogin = localStorage.getItem(\"firstLogin\");\n        if (firstLogin) {\n            const refreshToken = async () => {\n                try {\n                    const res = await axios.get(\"/user/refresh_token\");\n                    setToken(res.data.accesstoken);\n                    setTimeout(() => {\n                        refreshToken();\n                    }, 10 * 60 * 1000);\n                } catch (err) {\n                    if (err.response) {\n                        console.error(`Error en la respuesta del servidor: ${err.response.status} - ${err.response.data}`);\n                    } else if (err.request) {\n                        console.error('No hubo respuesta del servidor:', err.request);\n                    } else {\n                        console.error('Error:', err.message);\n                    }\n                }\n            };\n            refreshToken();\n        }\n    }, []);\n\n\n    ProductsAPI()\n    const state={\n        token: [token, setToken],\n        ProductsAPI: ProductsAPI(),\n        UserAPI : UserAPI(token),\n        CategoriesAPI: CategoriesAPI()\n    }\n\n    return(\n        <GlobalState.Provider value={state}>\n            {children}\n        </GlobalState.Provider>\n    )\n}\n\n"]},"metadata":{},"sourceType":"module"}