{"ast":null,"code":"import _objectSpread from\"C:\\\\Users\\\\Fabian FF\\\\Desktop\\\\envio\\\\sportShop\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\objectSpread2.js\";import _toConsumableArray from\"C:\\\\Users\\\\Fabian FF\\\\Desktop\\\\envio\\\\sportShop\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\toConsumableArray.js\";import _asyncToGenerator from\"C:\\\\Users\\\\Fabian FF\\\\Desktop\\\\envio\\\\sportShop\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";import _slicedToArray from\"C:\\\\Users\\\\Fabian FF\\\\Desktop\\\\envio\\\\sportShop\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\Fabian FF\\\\Desktop\\\\envio\\\\sportShop\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import{useState,useEffect}from'react';import axios from'axios';axios.defaults.withCredentials=true;function UserAPI(token){//NO OLVIDAR PASAR EL TOKEN A LA FUNCION PRINCIPAL\nvar _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLogged=_useState2[0],setIsLogged=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isAdmin=_useState4[0],setIsAdmin=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),cart=_useState6[0],setCart=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),history=_useState8[0],setHistory=_useState8[1];useEffect(function(){if(token){var getUser=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(\"/user/infor\",{headers:{Authorization:token}});case 3:res=_context.sent;setIsLogged(true);res.data.role===1?setIsAdmin(true):setIsAdmin(false);setCart(res.data.cart);_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);alert(_context.t0.response.data.msg);case 12:case\"end\":return _context.stop();}}},_callee,null,[[0,9]]);}));return function getUser(){return _ref.apply(this,arguments);};}();getUser();//no olvidar iniciar la funcion\n}},[token]);var addCart=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(product){var check;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(isLogged){_context2.next=2;break;}return _context2.abrupt(\"return\",alert(\"Favor iniciar sesi칩n o login para comprar\"));case 2:check=cart.every(function(item){return item._id!==product._id;});if(!check){_context2.next=9;break;}setCart([].concat(_toConsumableArray(cart),[_objectSpread(_objectSpread({},product),{},{quantity:1})]));_context2.next=7;return axios.patch(\"/user/addcart\",{cart:[].concat(_toConsumableArray(cart),[_objectSpread(_objectSpread({},product),{},{quantity:0})])},{headers:{Authorization:token}});case 7:_context2.next=10;break;case 9:alert(\"Este producto ha sido a침adido a su carrito de compras\");case 10:case\"end\":return _context2.stop();}}},_callee2);}));return function addCart(_x){return _ref2.apply(this,arguments);};}();return{isLogged:[isLogged,setIsLogged],isAdmin:[isAdmin,setIsAdmin],cart:[cart,setCart],addCart:addCart,history:[history,setHistory]};}export default UserAPI;","map":{"version":3,"sources":["C:/Users/Fabian FF/Desktop/envio/sportShop/client/src/api/UserAPI.js"],"names":["useState","useEffect","axios","defaults","withCredentials","UserAPI","token","isLogged","setIsLogged","isAdmin","setIsAdmin","cart","setCart","history","setHistory","getUser","get","headers","Authorization","res","data","role","alert","response","msg","addCart","product","check","every","item","_id","quantity","patch"],"mappings":"wuBAAA,OAAQA,QAAR,CAAkBC,SAAlB,KAAkC,OAAlC,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CAGAA,KAAK,CAACC,QAAN,CAAeC,eAAf,CAAiC,IAAjC,CAEA,QAASC,CAAAA,OAAT,CAAiBC,KAAjB,CAAwB,CAAE;AACtB,cAAgCN,QAAQ,CAAC,KAAD,CAAxC,wCAAOO,QAAP,eAAiBC,WAAjB,eACA,eAA8BR,QAAQ,CAAC,KAAD,CAAtC,yCAAOS,OAAP,eAAgBC,UAAhB,eACA,eAAwBV,QAAQ,CAAC,EAAD,CAAhC,yCAAOW,IAAP,eAAaC,OAAb,eACA,eAA8BZ,QAAQ,CAAC,EAAD,CAAtC,yCAAOa,OAAP,eAAgBC,UAAhB,eAEAb,SAAS,CAAC,UAAI,CACV,GAAGK,KAAH,CAAS,CACL,GAAMS,CAAAA,OAAO,0FAAG,iLAEUb,CAAAA,KAAK,CAACc,GAAN,CAAU,aAAV,CAAyB,CACvCC,OAAO,CAAE,CAACC,aAAa,CAAEZ,KAAhB,CAD8B,CAAzB,CAFV,QAEFa,GAFE,eAKRX,WAAW,CAAC,IAAD,CAAX,CACAW,GAAG,CAACC,IAAJ,CAASC,IAAT,GAAkB,CAAlB,CAAsBX,UAAU,CAAC,IAAD,CAAhC,CAAyCA,UAAU,CAAC,KAAD,CAAnD,CACAE,OAAO,CAACO,GAAG,CAACC,IAAJ,CAAST,IAAV,CAAP,CAPQ,+EAURW,KAAK,CAAC,YAAIC,QAAJ,CAAaH,IAAb,CAAkBI,GAAnB,CAAL,CAVQ,oEAAH,kBAAPT,CAAAA,OAAO,0CAAb,CAaAA,OAAO,GAAE;AACZ,CAEJ,CAlBQ,CAkBP,CAACT,KAAD,CAlBO,CAAT,CAuBA,GAAMmB,CAAAA,OAAO,2FAAI,kBAAOC,OAAP,mIACTnB,QADS,2DACQe,KAAK,CAAC,2CAAD,CADb,SAGPK,KAHO,CAGChB,IAAI,CAACiB,KAAL,CAAW,SAAAC,IAAI,CAAE,CAC3B,MAAOA,CAAAA,IAAI,CAACC,GAAL,GAAaJ,OAAO,CAACI,GAA5B,CACH,CAFa,CAHD,KAMVH,KANU,0BAOTf,OAAO,8BAAKD,IAAL,kCAAce,OAAd,MAAuBK,QAAQ,CAAE,CAAjC,KAAP,CAPS,uBAQH7B,CAAAA,KAAK,CAAC8B,KAAN,CAAY,eAAZ,CAA6B,CAACrB,IAAI,8BAAKA,IAAL,kCAAce,OAAd,MAAuBK,QAAQ,CAAE,CAAjC,IAAL,CAA7B,CAAwE,CAC1Ed,OAAO,CAAE,CAACC,aAAa,CAAEZ,KAAhB,CADiE,CAAxE,CARG,uCAYTgB,KAAK,CAAC,uDAAD,CAAL,CAZS,yDAAJ,kBAAPG,CAAAA,OAAO,6CAAb,CAeA,MAAO,CACHlB,QAAQ,CAAG,CAACA,QAAD,CAAWC,WAAX,CADR,CAEHC,OAAO,CAAE,CAACA,OAAD,CAAUC,UAAV,CAFN,CAGHC,IAAI,CAAE,CAACA,IAAD,CAAOC,OAAP,CAHH,CAIHa,OAAO,CAAEA,OAJN,CAKHZ,OAAO,CAAE,CAACA,OAAD,CAAUC,UAAV,CALN,CAAP,CAQH,CAED,cAAeT,CAAAA,OAAf","sourcesContent":["import {useState, useEffect} from 'react';\nimport axios from 'axios';  \n\n\naxios.defaults.withCredentials = true \n\nfunction UserAPI(token) { //NO OLVIDAR PASAR EL TOKEN A LA FUNCION PRINCIPAL\n    const [isLogged, setIsLogged] = useState(false)\n    const [isAdmin, setIsAdmin] = useState(false)\n    const [cart, setCart] = useState([])\n    const [history, setHistory] = useState([])\n\n    useEffect(()=>{\n        if(token){\n            const getUser = async ()=>{\n                try {\n                    const res = await axios.get(\"/user/infor\", {\n                        headers: {Authorization: token}\n                    })\n                    setIsLogged(true)\n                    res.data.role === 1 ? setIsAdmin(true) : setIsAdmin(false)\n                    setCart(res.data.cart)\n                    \n                } catch (err) {\n                    alert(err.response.data.msg)\n                }\n            }\n            getUser()//no olvidar iniciar la funcion\n        }\n\n    },[token])\n\n    \n\n\n    const addCart =  async (product)=>{\n        if(!isLogged) return alert(\"Favor iniciar sesi칩n o login para comprar\")\n\n        const check = cart.every(item=>{\n            return item._id !== product._id\n        })\n        if(check){\n            setCart([...cart,{...product, quantity: 1}])\n            await axios.patch(\"/user/addcart\", {cart:[...cart,{...product, quantity: 0}]},{\n                headers: {Authorization: token}\n            })\n        }else{\n            alert(\"Este producto ha sido a침adido a su carrito de compras\")\n        }\n    }\n    return { \n        isLogged : [isLogged, setIsLogged],\n        isAdmin: [isAdmin, setIsAdmin],\n        cart: [cart, setCart],\n        addCart: addCart,\n        history: [history, setHistory]\n\n}\n}\n\nexport default UserAPI;\n"]},"metadata":{},"sourceType":"module"}