{"ast":null,"code":"import _toConsumableArray from\"C:\\\\Users\\\\Fabian FF\\\\Desktop\\\\envio\\\\sportShop\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\toConsumableArray.js\";import _asyncToGenerator from\"C:\\\\Users\\\\Fabian FF\\\\Desktop\\\\envio\\\\sportShop\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";import _slicedToArray from\"C:\\\\Users\\\\Fabian FF\\\\Desktop\\\\envio\\\\sportShop\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\Fabian FF\\\\Desktop\\\\envio\\\\sportShop\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useContext,useState,useEffect}from'react';import{GlobalState}from'../../../GlobalState';import axios from'axios';import PaypalButton from'./PaypalButton';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";axios.defaults.withCredentials=true;function Cart(){var state=useContext(GlobalState);var _state$UserAPI$cart=_slicedToArray(state.UserAPI.cart,2),cart=_state$UserAPI$cart[0],setCart=_state$UserAPI$cart[1];var _state$token=_slicedToArray(state.token,1),token=_state$token[0];var _useState=useState(0),_useState2=_slicedToArray(_useState,2),total=_useState2[0],setTotal=_useState2[1];useEffect(function(){var getTotal=function getTotal(){var total=cart.reduce(function(prev,item){return prev+item.price*item.quantity;},0);setTotal(total);};getTotal();},[cart]);var addToCart=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(cart){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.patch(\"/user/addcart\",{cart:cart},{headers:{Authorization:token}});case 2:case\"end\":return _context.stop();}}},_callee);}));return function addToCart(_x){return _ref.apply(this,arguments);};}();var increment=function increment(id){cart.forEach(function(item){if(item._id===id){item.quantity+=1;}});setCart(_toConsumableArray(cart));addToCart(cart);};var decrement=function decrement(id){cart.forEach(function(item){if(item._id===id){item.quantity===1?item.quantity=1:item.quantity-=1;}});setCart(_toConsumableArray(cart));addToCart(cart);};var removeProduct=function removeProduct(id){if(window.confirm(\"esta seguro que quiere eliminar este producto de su carrito?\")){cart.forEach(function(item,index){if(item._id===id){cart.splice(index,1);}});setCart(_toConsumableArray(cart));addToCart(cart);}};var tranSuccess=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(payment){var paymentID,address;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:paymentID=payment.paymentID,address=payment.address;_context2.next=3;return axios.post(\"/api/payment\",{cart:cart,paymentID:paymentID,address:address},{headers:{Authorization:token}});case 3:setCart([]);addToCart([]);alert(\"Ha realizado un pedido con éxito.\");case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function tranSuccess(_x2){return _ref2.apply(this,arguments);};}();if(cart.length===0)return/*#__PURE__*/_jsx(\"h2\",{style:{textAlign:\"center\",fontSize:\"5rem\"},children:\"Su Carrito est\\xE1 Vac\\xEDo\"});return/*#__PURE__*/_jsxs(\"div\",{children:[cart.map(function(product){return/*#__PURE__*/_jsxs(\"div\",{className:\"detail cart\",children:[/*#__PURE__*/_jsx(\"img\",{src:product.images.url,alt:\"\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"box-detail\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[product.title,\" \"]}),/*#__PURE__*/_jsxs(\"h3\",{children:[\"$\",product.price*product.quantity,\" \"]}),/*#__PURE__*/_jsxs(\"p\",{children:[product.description,\" \"]}),/*#__PURE__*/_jsxs(\"p\",{children:[product.content,\" \"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"amount\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return decrement(product._id);},children:\" - \"}),/*#__PURE__*/_jsxs(\"span\",{children:[\" \",product.quantity,\" \"]}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return increment(product._id);},children:\" + \"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"delete\",onClick:function onClick(){return removeProduct(product._id);},children:\"X\"})]})]},product._id);}),/*#__PURE__*/_jsxs(\"div\",{className:\"total\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Total: $ \",total,\" \"]}),/*#__PURE__*/_jsx(PaypalButton,{total:total,tranSuccess:tranSuccess})]})]});}export default Cart;","map":{"version":3,"sources":["C:/Users/Fabian FF/Desktop/envio/sportShop/client/src/components/mainpages/cart/Cart.js"],"names":["React","useContext","useState","useEffect","GlobalState","axios","PaypalButton","defaults","withCredentials","Cart","state","UserAPI","cart","setCart","token","total","setTotal","getTotal","reduce","prev","item","price","quantity","addToCart","patch","headers","Authorization","increment","id","forEach","_id","decrement","removeProduct","window","confirm","index","splice","tranSuccess","payment","paymentID","address","post","alert","length","textAlign","fontSize","map","product","images","url","title","description","content"],"mappings":"slBAAA,MAAOA,CAAAA,KAAP,EAAcC,UAAd,CAA0BC,QAA1B,CAAoCC,SAApC,KAAoD,OAApD,CACA,OAAQC,WAAR,KAA0B,sBAA1B,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,YAAP,KAAyB,gBAAzB,C,wFAGAD,KAAK,CAACE,QAAN,CAAeC,eAAf,CAA+B,IAA/B,CAEA,QAASC,CAAAA,IAAT,EAAgB,CAEd,GAAMC,CAAAA,KAAK,CAAGT,UAAU,CAACG,WAAD,CAAxB,CACA,uCAAuBM,KAAK,CAACC,OAAN,CAAcC,IAArC,IAAMA,IAAN,wBAAYC,OAAZ,wBACA,gCAAgBH,KAAK,CAACI,KAAtB,IAAOA,KAAP,iBACA,cAAyBZ,QAAQ,CAAC,CAAD,CAAjC,wCAAOa,KAAP,eAAcC,QAAd,eAKAb,SAAS,CAAC,UAAI,CACZ,GAAMc,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,EAAK,CACpB,GAAMF,CAAAA,KAAK,CAAGH,IAAI,CAACM,MAAL,CAAY,SAACC,IAAD,CAAOC,IAAP,CAAc,CAClC,MAAOD,CAAAA,IAAI,CAAIC,IAAI,CAACC,KAAL,CAAaD,IAAI,CAACE,QAAjC,CACL,CAFa,CAEZ,CAFY,CAAd,CAGAN,QAAQ,CAACD,KAAD,CAAR,CACD,CALD,CAMAE,QAAQ,GACT,CARQ,CAQP,CAACL,IAAD,CARO,CAAT,CAUA,GAAMW,CAAAA,SAAS,0FAAG,iBAAOX,IAAP,wIACVP,CAAAA,KAAK,CAACmB,KAAN,CAAY,eAAZ,CAA4B,CAACZ,IAAI,CAAJA,IAAD,CAA5B,CAAmC,CACvCa,OAAO,CAAE,CAACC,aAAa,CAAEZ,KAAhB,CAD8B,CAAnC,CADU,uDAAH,kBAATS,CAAAA,SAAS,4CAAf,CAMA,GAAMI,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,CAACC,EAAD,CAAO,CACvBhB,IAAI,CAACiB,OAAL,CAAa,SAAAT,IAAI,CAAE,CACjB,GAAGA,IAAI,CAACU,GAAL,GAAaF,EAAhB,CAAmB,CACjBR,IAAI,CAACE,QAAL,EAAiB,CAAjB,CACD,CACF,CAJD,EAKAT,OAAO,oBAAKD,IAAL,EAAP,CACAW,SAAS,CAACX,IAAD,CAAT,CACD,CARD,CASA,GAAMmB,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,CAACH,EAAD,CAAO,CACvBhB,IAAI,CAACiB,OAAL,CAAa,SAAAT,IAAI,CAAE,CACjB,GAAGA,IAAI,CAACU,GAAL,GAAaF,EAAhB,CAAmB,CACjBR,IAAI,CAACE,QAAL,GAAkB,CAAlB,CAAsBF,IAAI,CAACE,QAAL,CAAgB,CAAtC,CAA0CF,IAAI,CAACE,QAAL,EAAiB,CAA3D,CACD,CACF,CAJD,EAKAT,OAAO,oBAAKD,IAAL,EAAP,CACAW,SAAS,CAACX,IAAD,CAAT,CACD,CARD,CASA,GAAMoB,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAAAJ,EAAE,CAAG,CACzB,GAAGK,MAAM,CAACC,OAAP,CAAgB,8DAAhB,CAAH,CAAmF,CAC/EtB,IAAI,CAACiB,OAAL,CAAa,SAACT,IAAD,CAAMe,KAAN,CAAc,CACzB,GAAGf,IAAI,CAACU,GAAL,GAAcF,EAAjB,CAAoB,CAClBhB,IAAI,CAACwB,MAAL,CAAaD,KAAb,CAAoB,CAApB,EACD,CACF,CAJD,EAKAtB,OAAO,oBAAKD,IAAL,EAAP,CACAW,SAAS,CAACX,IAAD,CAAT,CACH,CACF,CAVD,CAYA,GAAMyB,CAAAA,WAAW,2FAAG,kBAAOC,OAAP,4IAEXC,SAFW,CAEWD,OAFX,CAEXC,SAFW,CAEAC,OAFA,CAEWF,OAFX,CAEAE,OAFA,wBAIVnC,CAAAA,KAAK,CAACoC,IAAN,CAAW,cAAX,CAA2B,CAAC7B,IAAI,CAAJA,IAAD,CAAO2B,SAAS,CAATA,SAAP,CAAkBC,OAAO,CAAPA,OAAlB,CAA3B,CAAsD,CACzDf,OAAO,CAAE,CAACC,aAAa,CAAEZ,KAAhB,CADgD,CAAtD,CAJU,QAOhBD,OAAO,CAAC,EAAD,CAAP,CACAU,SAAS,CAAC,EAAD,CAAT,CACAmB,KAAK,CAAC,mCAAD,CAAL,CATgB,wDAAH,kBAAXL,CAAAA,WAAW,8CAAjB,CAaA,GAAGzB,IAAI,CAAC+B,MAAL,GAAgB,CAAnB,CACA,mBAAQ,WAAI,KAAK,CAAE,CAACC,SAAS,CAAE,QAAZ,CAAsBC,QAAQ,CAAC,MAA/B,CAAX,yCAAR,CAIA,mBACE,uBAEMjC,IAAI,CAACkC,GAAL,CAAS,SAAAC,OAAO,qBAGd,aAAK,SAAS,CAAC,aAAf,wBACE,YAAK,GAAG,CAAEA,OAAO,CAACC,MAAR,CAAeC,GAAzB,CAA8B,GAAG,CAAC,EAAlC,EADF,cAEI,aAAK,SAAS,CAAC,YAAf,wBACI,sBAAKF,OAAO,CAACG,KAAb,OADJ,cAGI,0BAAMH,OAAO,CAAC1B,KAAR,CAAgB0B,OAAO,CAACzB,QAA9B,OAHJ,cAII,qBAAIyB,OAAO,CAACI,WAAZ,OAJJ,cAKI,qBAAIJ,OAAO,CAACK,OAAZ,OALJ,cAMI,aAAK,SAAS,CAAC,QAAf,wBACE,eAAQ,OAAO,CAAE,yBAAKrB,CAAAA,SAAS,CAACgB,OAAO,CAACjB,GAAT,CAAd,EAAjB,iBADF,cAGE,4BAAQiB,OAAO,CAACzB,QAAhB,OAHF,cAIE,eAAQ,OAAO,CAAE,yBAAKK,CAAAA,SAAS,CAACoB,OAAO,CAACjB,GAAT,CAAd,EAAjB,iBAJF,GANJ,cAYI,YAAK,SAAS,CAAC,QAAf,CAAwB,OAAO,CAAE,yBAAIE,CAAAA,aAAa,CAACe,OAAO,CAACjB,GAAT,CAAjB,EAAjC,eAZJ,GAFJ,GAAkCiB,OAAO,CAACjB,GAA1C,CAHc,EAAhB,CAFN,cAyBI,aAAK,SAAS,CAAC,OAAf,wBACE,kCAAcf,KAAd,OADF,cAEE,KAAC,YAAD,EAAc,KAAK,CAAEA,KAArB,CAA4B,WAAW,CAAEsB,WAAzC,EAFF,GAzBJ,GADF,CAkCD,CAED,cAAe5B,CAAAA,IAAf","sourcesContent":["import React,{useContext, useState, useEffect} from 'react';\nimport {GlobalState} from '../../../GlobalState';\nimport axios from 'axios';\nimport PaypalButton from './PaypalButton';\n\n\naxios.defaults.withCredentials=true\n\nfunction Cart() {\n\n  const state = useContext(GlobalState)\n  const[cart, setCart] = state.UserAPI.cart\n  const [token] = state.token\n  const [total, setTotal]= useState(0)\n\n\n  \n\n  useEffect(()=>{\n    const getTotal = () =>{\n      const total = cart.reduce((prev, item)=>{\n            return prev + (item.price * item.quantity)\n      },0)\n      setTotal(total)\n    }\n    getTotal()\n  },[cart])\n\n  const addToCart = async (cart)=>{\n    await axios.patch(\"/user/addcart\",{cart},{\n      headers: {Authorization: token}\n    })\n  }\n\n  const increment = (id) =>{\n    cart.forEach(item=>{\n      if(item._id === id){\n        item.quantity += 1\n      }\n    })\n    setCart([...cart])\n    addToCart(cart)\n  }\n  const decrement = (id) =>{\n    cart.forEach(item=>{\n      if(item._id === id){\n        item.quantity === 1 ? item.quantity = 1 : item.quantity -= 1\n      }\n    })\n    setCart([...cart])\n    addToCart(cart)\n  }\n  const removeProduct = id =>{\n    if(window.confirm (\"esta seguro que quiere eliminar este producto de su carrito?\")){\n        cart.forEach((item,index)=>{\n          if(item._id ===  id){\n            cart.splice( index, 1)\n          }\n        })\n        setCart([...cart])\n        addToCart(cart)\n    }\n  }\n\n  const tranSuccess = async (payment)=>{\n    \n    const {paymentID, address} = payment\n\n      await axios.post(\"/api/payment\", {cart, paymentID, address},{\n         headers: {Authorization: token}\n      })\n      setCart([])\n      addToCart([])\n      alert(\"Ha realizado un pedido con éxito.\")\n  }\n\n\n  if(cart.length === 0)\n  return  <h2 style={{textAlign: \"center\", fontSize:\"5rem\"}} >Su Carrito está Vacío</h2>\n\n\n\n  return (\n    <div>\n        {\n          cart.map(product =>(\n           \n\n            <div className='detail cart' key={product._id} >\n              <img src={product.images.url} alt=\"\" />{/* aca cambie detailProduct por product */}\n                <div className='box-detail'>\n                    <h2>{product.title} </h2>\n                        \n                    <h3>${product.price * product.quantity} </h3>\n                    <p>{product.description} </p>\n                    <p>{product.content} </p>\n                    <div className=\"amount\">\n                      <button onClick={()=> decrement(product._id)}> - </button>\n                      \n                      <span> {product.quantity} </span>\n                      <button onClick={()=> increment(product._id)}> + </button>\n                    </div>\n                    <div className=\"delete\" onClick={()=>removeProduct(product._id)}>X</div>\n                </div>\n            </div>\n\n          ))\n        }\n        <div className=\"total\">\n          <h3>Total: $ {total} </h3>\n          <PaypalButton total={total} tranSuccess={tranSuccess} />\n        </div>\n\n\n    </div>\n  );\n}\n\nexport default Cart;\n"]},"metadata":{},"sourceType":"module"}