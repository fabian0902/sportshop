{"ast":null,"code":"import _asyncToGenerator from\"C:\\\\Users\\\\Fabian FF\\\\Desktop\\\\envio\\\\sportShop\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";import _slicedToArray from\"C:\\\\Users\\\\Fabian FF\\\\Desktop\\\\envio\\\\sportShop\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\Fabian FF\\\\Desktop\\\\envio\\\\sportShop\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useContext,useEffect}from'react';import{GlobalState}from'../../../GlobalState';import{Link}from'react-router-dom';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function OrderHistory(){var state=useContext(GlobalState);var _state$UserAPI$histor=_slicedToArray(state.UserAPI.history,2),history=_state$UserAPI$histor[0],setHistory=_state$UserAPI$histor[1];var _state$UserAPI$isAdmi=_slicedToArray(state.UserAPI.isAdmin,1),isAdmin=_state$UserAPI$isAdmi[0];var _state$token=_slicedToArray(state.token,1),token=_state$token[0];useEffect(function(){if(token){var getHistory=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res,_res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!isAdmin){_context.next=7;break;}_context.next=3;return axios.get(\"/api/payment\",{headers:{Authorization:token}});case 3:res=_context.sent;setHistory(res.data);_context.next=11;break;case 7:_context.next=9;return axios.get(\"/user/history\",{headers:{Authorization:token}});case 9:_res=_context.sent;setHistory(_res.data);case 11:case\"end\":return _context.stop();}}},_callee);}));return function getHistory(){return _ref.apply(this,arguments);};}();getHistory();}},[token,isAdmin,setHistory]);return/*#__PURE__*/_jsxs(\"div\",{className:\"history-page\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Historial\"}),/*#__PURE__*/_jsxs(\"h4\",{children:[\"Tienes \",history.length,\" ordenes\"]}),/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"ID de Pago\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Fecha de Compra\"}),/*#__PURE__*/_jsx(\"th\",{})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:history.map(function(items){return items._id?/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:items.paymentID}),/*#__PURE__*/_jsx(\"td\",{children:new Date(items.createdAt).toLocaleDateString()}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Link,{to:\"/history/\".concat(items._id),children:\" Detalles \"})})]},items._id):null;})})]})]});}export default OrderHistory;","map":{"version":3,"sources":["C:/Users/Fabian FF/Desktop/envio/sportShop/client/src/components/mainpages/history/OrderHistory.js"],"names":["React","useContext","useEffect","GlobalState","Link","axios","OrderHistory","state","UserAPI","history","setHistory","isAdmin","token","getHistory","get","headers","Authorization","res","data","length","map","items","_id","paymentID","Date","createdAt","toLocaleDateString"],"mappings":"2bAAA,MAAOA,CAAAA,KAAP,EAAcC,UAAd,CAA0BC,SAA1B,KAA0C,OAA1C,CACA,OAAQC,WAAR,KAA0B,sBAA1B,CACA,OAAQC,IAAR,KAAmB,kBAAnB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,C,wFAIA,QAASC,CAAAA,YAAT,EAAwB,CACpB,GAAMC,CAAAA,KAAK,CAAGN,UAAU,CAACE,WAAD,CAAxB,CACA,yCAA8BI,KAAK,CAACC,OAAN,CAAcC,OAA5C,IAAOA,OAAP,0BAAgBC,UAAhB,0BACA,yCAAkBH,KAAK,CAACC,OAAN,CAAcG,OAAhC,IAAOA,OAAP,0BACA,gCAAgBJ,KAAK,CAACK,KAAtB,IAAOA,KAAP,iBAGAV,SAAS,CAAC,UAAI,CACV,GAAGU,KAAH,CAAS,CACL,GAAMC,CAAAA,UAAU,0FAAG,oJACZF,OADY,+CAEON,CAAAA,KAAK,CAACS,GAAN,CAAU,cAAV,CAAyB,CACvCC,OAAO,CAAE,CAACC,aAAa,CAAEJ,KAAhB,CAD8B,CAAzB,CAFP,QAELK,GAFK,eAKXP,UAAU,CAACO,GAAG,CAACC,IAAL,CAAV,CALW,oDAQOb,CAAAA,KAAK,CAACS,GAAN,CAAU,eAAV,CAA0B,CACxCC,OAAO,CAAE,CAACC,aAAa,CAAEJ,KAAhB,CAD+B,CAA1B,CARP,QAQLK,IARK,eAWXP,UAAU,CAACO,IAAG,CAACC,IAAL,CAAV,CAXW,uDAAH,kBAAVL,CAAAA,UAAU,0CAAhB,CAgBAA,UAAU,GACb,CAEJ,CArBQ,CAqBP,CAACD,KAAD,CAAQD,OAAR,CAAgBD,UAAhB,CArBO,CAAT,CAwBA,mBACI,aAAK,SAAS,CAAC,cAAf,wBACI,iCADJ,cAEI,gCAAYD,OAAO,CAACU,MAApB,cAFJ,cAGQ,sCACI,oCACI,mCACI,kCADJ,cAEI,uCAFJ,cAGI,aAHJ,GADJ,EADJ,cASI,uBAEhBV,OAAO,CAACW,GAAR,CAAY,SAAAC,KAAK,QAAIA,CAAAA,KAAK,CAACC,GAAN,cACjB,mCACI,oBAAKD,KAAK,CAACE,SAAX,EADJ,cAEI,oBAAK,GAAIC,CAAAA,IAAJ,CAASH,KAAK,CAACI,SAAf,EAA0BC,kBAA1B,EAAL,EAFJ,cAGI,iCAAI,KAAC,IAAD,EAAM,EAAE,oBAAcL,KAAK,CAACC,GAApB,CAAR,wBAAJ,EAHJ,GAASD,KAAK,CAACC,GAAf,CADiB,CAMjB,IANa,EAAjB,CAFgB,EATJ,GAHR,GADJ,CA8BH,CAED,cAAehB,CAAAA,YAAf","sourcesContent":["import React,{useContext, useEffect} from 'react';\nimport {GlobalState} from '../../../GlobalState';\nimport {Link} from 'react-router-dom';\nimport axios from 'axios';\n\n\n\nfunction OrderHistory() {\n    const state = useContext(GlobalState)\n    const [history, setHistory] = state.UserAPI.history\n    const [isAdmin] = state.UserAPI.isAdmin\n    const [token] = state.token\n\n\n    useEffect(()=>{\n        if(token){\n            const getHistory = async() =>{\n                if(isAdmin){\n                    const res = await axios.get(\"/api/payment\",{\n                        headers: {Authorization: token}\n                    })\n                    setHistory(res.data);\n\n                }else{\n                    const res = await axios.get(\"/user/history\",{\n                        headers: {Authorization: token}\n                    })\n                    setHistory(res.data);\n\n                }\n                \n            }\n            getHistory()\n        }\n\n    },[token, isAdmin,setHistory])\n\n\n    return (\n        <div className=\"history-page\">\n            <h2>Historial</h2>\n            <h4>Tienes {history.length} ordenes</h4>\n                <table>\n                    <thead>\n                        <tr>\n                            <th>ID de Pago</th>\n                            <th>Fecha de Compra</th>\n                            <th></th>\n                        </tr>\n\n                    </thead>\n                    <tbody>\n                    {\n    history.map(items => items._id ? (\n        <tr key={items._id}>\n            <td>{items.paymentID}</td>\n            <td>{new Date(items.createdAt).toLocaleDateString()}</td>\n            <td><Link to={`/history/${items._id}`}> Detalles </Link></td>\n        </tr>\n    ) : null)\n}\n\n                    </tbody>\n                    \n                </table>\n        </div>\n        \n    );\n}\n\nexport default OrderHistory;\n"]},"metadata":{},"sourceType":"module"}